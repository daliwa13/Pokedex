let pokemonRepository = function () { let e = []; function t(t) { 'object' == typeof t && 'name' in t ? e.push(t) : console.log('pokemon is not correct') } function n() { return e } function o(e) { return fetch(e.detailsUrl).then(function (e) { return e.json() }).then(function (t) { e.imageUrl = t.sprites.other.dream_world.front_default, e.height = t.height, e.types = t.types, e.weight = t.weight }).catch(function (e) { console.error(e) }) } function a(e) { o(e).then(function () { var t; let n, o, a; t = e, n = $('.modal-body'), o = $('.modal-title'), a = $('<img>'), n.empty(), o.empty(), o.text(t.name.toUpperCase()), a = $('<img>').addClass('modal-img').attr('src', t.imageUrl).attr('alt', t.name), n.append(a), n.append('<br><p>Height: ' + t.height + '</p>'), n.append('<p>Weight: ' + t.weight + '</p>'), t.types.forEach(e => { let t = $('<button></button>'); t.addClass('type-button ' + e.type.name), t.text(e.type.name.toLowerCase()), n.append(t) }), $('#pokemonModal').modal('show') }) } return { getAll: n, add: t, filter: function t(n) { if ('string' != typeof n) return console.error('Pokemon name must be a string!'), []; let o = n.trim().toLowerCase(); return o ? e.filter(e => e.name.toLowerCase().includes(o)) : e }, addListItem: function e(t) { let n = $('#pokemon-list-row'), o = $('<div></div>'), r = $('<div></div>'), i = $('<h2></h2>'); o.addClass('card', 'pokemon-list-card'), r.addClass('pokemon-list-button', 'card-body'), i.text(t.name[0].toUpperCase() + t.name.slice(1)), r.append(i), o.append(r), n.append(o), o.on('click', function () { a(t) }) }, loadList: function e(n) { return fetch(n).then(function (e) { return e.json() }).then(function (e) { e.results.forEach(function (e) { t({ name: e.name, detailsUrl: e.url }) }) }).catch(function (e) { console.error(e) }) }, loadDetails: o, showDetails: a } }(), pokeball = document.querySelector('.pokeball'), instructions = document.querySelector('#instructions'), apiUrl = 'https://pokeapi.co/api/v2/pokemon/?limit=150', searchForm = document.querySelector('#search-form'), searchButton = document.querySelector('#search-input-btn'); function appendReloadButton() { let e = document.querySelector('#pokemon-list-row'), t = document.querySelector('#reload-button'); t && t.remove(); let n = document.createElement('button'); n.id = 'reload-button', n.className = 'btn btn-outline-danger mt-3', n.textContent = 'Reload pokemon list', n.addEventListener('click', function () { e.innerHTML = '', pokemonRepository.loadList(apiUrl).then(function () { pokemonRepository.getAll().forEach(function (e) { pokemonRepository.addListItem(e) }) }) }), e.appendChild(n) } function handleSearch(e) { e.preventDefault(); let t = document.querySelector('#search-input').value.toLowerCase(), n = pokemonRepository.filter(t), o = document.querySelector('#pokemon-list-row'); if (o.innerHTML = '', 0 === n.length) { let a = document.createElement('p'); a.textContent = 'No Pokemon with that name has been found', o.appendChild(a), appendReloadButton(); return } n.forEach(function (e) { pokemonRepository.addListItem(e) }), appendReloadButton() } pokeball.addEventListener('click', function () { pokeball.classList.add('disappear'), instructions.classList.add('move-away'), pokeball.addEventListener('transitionend', function () { pokeball.style.display = 'none', instructions.style.display = 'none', pokemonRepository.loadList(apiUrl).then(function () { pokemonRepository.getAll().forEach(function (e) { pokemonRepository.addListItem(e) }) }) }) }), searchForm.addEventListener('submit', handleSearch), searchButton.addEventListener('click', handleSearch);